<UserControl 
    x:Class="otor.msixhero.ui.Modules.Main.View.MainView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:Fluent="urn:fluent-ribbon"
    regions:ViewModelLocator.AutoWireViewModel="True"
    xmlns:regions="http://prismlibrary.com/"
    xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:routedCommand="clr-namespace:otor.msixhero.ui.Commands.RoutedCommand"
    xmlns:commands="clr-namespace:otor.msixhero.ui.Commands"
    xmlns:viewModel="clr-namespace:otor.msixhero.ui.Modules.Main.ViewModel"
    xmlns:system="clr-namespace:System;assembly=System.Runtime"
    xmlns:enums="clr-namespace:otor.msixhero.lib.Domain.Appx.Packages;assembly=msixhero.lib"
    xmlns:view="clr-namespace:otor.msixhero.ui.Modules.Main.View"
    xmlns:viewModel1="clr-namespace:otor.msixhero.ui.ViewModel"
    xmlns:progressOverlay="clr-namespace:otor.msixhero.ui.Controls.ProgressOverlay"
    xmlns:uac="clr-namespace:otor.msixhero.ui.Controls.Uac"
    xmlns:viewModel11="clr-namespace:otor.msixhero.ui.Modules.PackageList.ViewModel"
    xmlns:modules="clr-namespace:otor.msixhero.ui.Modules"
    d:DesignWidth="600"
    mc:Ignorable="d"
    d:DataContext="{d:DesignInstance viewModel:MainViewModel}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/msixhero;component/Themes/Generic.xaml" />
                <ResourceDictionary Source="/msixhero;component/Themes/Converters.xaml" />
                <ResourceDictionary Source="/msixhero;component/Themes/Extras.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <UserControl.CommandBindings>
        <CommandBinding Command="Close" Executed="Close_OnExecuted"></CommandBinding>
    </UserControl.CommandBindings>
    <routedCommand:RoutedCommandHandlers.Commands>
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Settings}" Command="{Binding CommandHandler.Settings}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="Help" Command="{Binding CommandHandler.Help}" />
    </routedCommand:RoutedCommandHandlers.Commands>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.Resources>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
            <Style TargetType="Fluent:RibbonGroupBox">
                <Style.Resources>
                    <Storyboard x:Key="Animation">
                        <DoubleAnimation From="0.0" To="1.0" Duration="00:00:0.15" Storyboard.TargetProperty="Opacity" />
                        <DoubleAnimation From="-24" To="0" Duration="00:00:0.15" Storyboard.TargetProperty="RenderTransform.X" />
                    </Storyboard>
                </Style.Resources>
                <Style.Triggers>
                    <Trigger Property="IsVisible" Value="True">
                        <Trigger.EnterActions>
                            <BeginStoryboard Storyboard="{StaticResource Animation}" />
                        </Trigger.EnterActions>
                    </Trigger>
                    <!--<EventTrigger RoutedEvent="Loaded">
                        <EventTrigger.Actions>
                            <BeginStoryboard Storyboard="{StaticResource Animation}" />
                        </EventTrigger.Actions>
                    </EventTrigger>-->
                </Style.Triggers>
                <Setter Property="RenderTransform">
                    <Setter.Value>
                        <TranslateTransform />
                    </Setter.Value>
                </Setter>
            </Style>
        </Grid.Resources>

            <Fluent:Ribbon
                FocusManager.IsFocusScope="True"
                CanQuickAccessLocationChanging="False"
                CanCustomizeQuickAccessToolBar="False"
                CanCustomizeRibbon="False"
                IsQuickAccessToolBarMenuDropDownVisible="False"
                CanCustomizeQuickAccessToolBarItems="False"
                x:Name="Ribbon"  Grid.Row="0">
            <Fluent:Ribbon.ContextualGroups>
                <Fluent:RibbonContextualTabGroup 
                    x:Name="SelectedPackage"
                    Header="Selected package" 
                    Background="GreenYellow" 
                    BorderBrush="LightGreen" />
                <Fluent:RibbonContextualTabGroup 
                    x:Name="SelectedVolume"
                    Header="Selected volume" 
                    Background="GreenYellow" 
                    BorderBrush="LightGreen" />
            </Fluent:Ribbon.ContextualGroups>

            <Fluent:Ribbon.ToolBarItems>
                <Fluent:Button 
                    Command="Help"
                    Size="Small">
                    <Fluent:Button.Icon>
                        <Image Source="/Resources/Images/help.png" Width="16" Height="16" SnapsToDevicePixels="True" UseLayoutRounding="True" Stretch="None" />
                    </Fluent:Button.Icon>
                </Fluent:Button>
            </Fluent:Ribbon.ToolBarItems>

            <!--Backstage-->
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage>
                    <routedCommand:RoutedCommandHandlers.Commands>
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Settings}" Command="{Binding BackstageCommandHandler.Settings}" />
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Pack}" Command="{Binding BackstageCommandHandler.Pack}" />
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.AppInstaller}" Command="{Binding BackstageCommandHandler.AppInstaller}" />
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.PackageExpert}" Command="{Binding BackstageCommandHandler.PackageExpert}" />
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.ModificationPackage}" Command="{Binding BackstageCommandHandler.ModificationPackage}" />
                        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.AppAttach}" Command="{Binding BackstageCommandHandler.AppAttach}" />
                    </routedCommand:RoutedCommandHandlers.Commands>
                    <Fluent:BackstageTabControl>
                        <Fluent:BackstageTabItem Header="New">
                            <Fluent:BackstageTabItem.Icon>
                                <Path Fill="White" Opacity="0.7" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorBulb}" />
                            </Fluent:BackstageTabItem.Icon>
                            <view:BackStageNewView />
                        </Fluent:BackstageTabItem>
                        <Fluent:BackstageTabItem Header="Open">
                            <Fluent:BackstageTabItem.Icon>
                                <Path Fill="White" Opacity="0.7" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorOpen}" />
                            </Fluent:BackstageTabItem.Icon>
                            <view:BackStageOpenView />
                        </Fluent:BackstageTabItem>
                        <Fluent:Button Header="Settings" Command="{x:Static commands:MsixHeroCommands.Settings}">
                            <Fluent:Button.Icon>
                                <Path Opacity="0.7" Fill="White" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorGear}" />
                            </Fluent:Button.Icon>
                        </Fluent:Button>
                        <Fluent:SeparatorTabItem />
                        <Fluent:Button Header="Exit" Command="Close">
                            <Fluent:Button.Icon>
                                <Path Fill="White" Opacity="0.7" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerOff}" />
                            </Fluent:Button.Icon>
                        </Fluent:Button>
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>

            <Fluent:RibbonTabItem 
                x:Name="RibbonTabVolumesHome"
                Header="Home">

                <Fluent:RibbonGroupBox Header="Actions">
                    <Fluent:Button Size="Large" Header="Refresh volumes" Command="Refresh" SizeDefinition="Large, Large, Small">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Separator />

                    <Fluent:Button Header="Add volume..." Command="New">
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource LargeIcon}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <!--Tabs-->
            <Fluent:RibbonTabItem 
                x:Name="RibbonTabHome"
                Header="Home" ReduceOrder="
                  RibbonHomeActions,RibbonHomeActions,RibbonHomeActions,
                  RibbonHomeTroubleshooting,RibbonHomeTroubleshooting,RibbonHomeTroubleshooting">

                <Fluent:RibbonGroupBox x:Name="RibbonHomeActions" Header="Actions">
                    <Fluent:Button Size="Large" Header="Refresh list" Command="Refresh" SizeDefinition="Large, Large, Small">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Separator />

                    <Fluent:Button Header="Install package for current user..." Command="{x:Static commands:MsixHeroCommands.AddPackage}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Provision package for all users..." Command="{x:Static commands:MsixHeroCommands.AddPackage}">
                        <Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Data="{StaticResource VectorAddUsers}"  Style="{StaticResource LargeIcon}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox x:Name="RibbonHomeTroubleshooting" Header="Troubleshooting and diagnostics" >
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorDebugging}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="PowerShell Console" Command="{x:Static commands:MsixHeroCommands.OpenPowerShell}" SizeDefinition="Large, Medium, Medium">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorPowerShell}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerShell}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Apps and features" SizeDefinition="Medium,Medium,Small" Command="{x:Static commands:MsixHeroCommands.OpenAppsFeatures}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorPowerList}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerList}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Developer settings" SizeDefinition="Medium,Medium,Small" Command="{x:Static commands:MsixHeroCommands.OpenDevSettings}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Separator />
                    <Fluent:Button Header="MSIX event logs" Command="{x:Static commands:MsixHeroCommands.OpenLogs}" SizeDefinition="Large, Medium, Medium">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorLogs}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorLogs}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem 
                x:Name="RibbonTabView"
                Header="View"
                ReduceOrder="RibbonViewGroupBy,RibbonViewGroupBy,RibbonViewGroupBy">

                <Fluent:RibbonGroupBox x:Name="RibbonHomeContext" Header="Context">
                    <Fluent:Button Size="Large" Header="Refresh list" Command="Refresh" SizeDefinition="Large, Large, Small">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Separator />

                    <Fluent:RadioButton GroupName="Users1" Header="Current user" IsChecked="{Binding Context, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:PackageContext.CurrentUser}}">
                        <Fluent:RadioButton.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:RadioButton.SizeDefinition>
                        <Fluent:RadioButton.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:RadioButton.Icon>
                    </Fluent:RadioButton>
                    <Fluent:RadioButton Header="All users"  GroupName="Users2" IsChecked="{Binding Context, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:PackageContext.AllUsers}}">
                        <Fluent:RadioButton.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:RadioButton.SizeDefinition>
                        <Fluent:RadioButton.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUsers}" />
                        </Fluent:RadioButton.Icon>
                    </Fluent:RadioButton>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="App types">
                    <Fluent:CheckBox IsChecked="{Binding ShowStoreApps, Converter={StaticResource NegativeConverter}}" Header="Hide Store apps" />
                    <Fluent:CheckBox IsChecked="{Binding ShowSideLoadedApps, Converter={StaticResource NegativeConverter}}" Header="Hide Side-loaded apps" />
                    <Fluent:CheckBox IsChecked="{Binding ShowSystemApps, Converter={StaticResource NegativeConverter}}" Header="Hide System apps" />
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Group by" x:Name="RibbonViewGroupBy">
                    <Fluent:InRibbonGallery Orientation="Horizontal" ItemWidth="64" ItemHeight="58" 
                                                SelectedValue="{Binding Group}" SelectedValuePath="Tag" Size="Large">
                        <Fluent:InRibbonGallery.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Large" Small="Middle" />
                        </Fluent:InRibbonGallery.SizeDefinition>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.None}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorCollection}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="None" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.Publisher}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorUsers2}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="Publisher" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.Type}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorBulb}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="Type" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                    </Fluent:InRibbonGallery>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Panel">
                    <Fluent:ToggleButton Header="Show information panel" Size="Large" IsChecked="{Binding ShowSidebar}">
                        <Fluent:ToggleButton.LargeIcon>
                            <Path Data="{StaticResource VectorSidebarRight}" Style="{StaticResource LargeIcon}" />
                        </Fluent:ToggleButton.LargeIcon>
                    </Fluent:ToggleButton>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem 
                x:Name="RibbonTabEdit"
                Header="Edit" 
                ReduceOrder=",
                            RibbonToolsPack,RibbonToolsPack,RibbonToolsPack,
                            RibbonCodeSigning,RibbonCodeSigning,RibbonCodeSigning
                            RibbonToolsCreate,RibbonToolsCreate,RibbonToolsCreate,">
                <Fluent:RibbonGroupBox Header="Packing + unpacking" x:Name="RibbonToolsPack">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorPack}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Unpack MSIX package..." Command="{x:Static commands:MsixHeroCommands.Unpack}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Small" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorUnpack}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorUnpack}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Pack folder to MSIX..." Command="{x:Static commands:MsixHeroCommands.Pack}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Small" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorPack}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorPack}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Code-signing" x:Name="RibbonCodeSigning">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSign}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Sign package..." Command="{x:Static commands:MsixHeroCommands.OpenResign}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Other editors and generators" x:Name="RibbonToolsCreate">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Modification package stub generator" Command="{x:Static commands:MsixHeroCommands.ModificationPackage}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>

                    <Fluent:Button Header="MSIX app attach VHD generator" Command="{x:Static commands:MsixHeroCommands.AppAttach}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorNetworkDrive}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorNetworkDrive}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>

                    <Fluent:Button Header="App installer editor" CommandParameter="{x:Static viewModel11:AppInstallerCommandParameter.Empty}" Command="{x:Static commands:MsixHeroCommands.AppInstaller}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>

                    <Fluent:Button Visibility="Collapsed" Header="Generate bundle...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorBundle}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorBundle}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Visibility="Collapsed" Header="Generate MSIX Core...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorBulb}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorBulb}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Visibility="Collapsed" Header="Inject PSF...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorImport}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorImport}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem 
                x:Name="RibbonTabCertificates"
                Header="Certificates"
                ReduceOrder="RibbonToolsCerts1,RibbonToolsCerts1,RibbonToolsCerts1
                            RibbonToolsCerts2,RibbonToolsCerts2,RibbonToolsCerts2">
                <Fluent:RibbonGroupBox Header="Code-signing" x:Name="RibbonToolsCerts1">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorSelfSign}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Create self-signed..." Command="{x:Static commands:MsixHeroCommands.CreateSelfSign}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Extract certificate from MSIX..." Command="{x:Static commands:MsixHeroCommands.ExtractCertifiacte}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorExport}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Certificate management" x:Name="RibbonToolsCerts2">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorSign}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Install certificate..." Command="{x:Static commands:MsixHeroCommands.InstallCertificate}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorImport}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorImport}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Large" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="User certificates" Command="{x:Static commands:MsixHeroCommands.CertManager}">
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Computer certificates" Command="{x:Static commands:MsixHeroCommands.CertManager}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>

                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorSystem}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSystem}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem 
                x:Name="RibbonTabManagement"
                ReduceOrder="
                    RibbonManagementNavi,RibbonManagementNavi,RibbonManagementNavi,
                    RibbonManagementControl,RibbonManagementControl,RibbonManagementControl"
                Header="Management" Group="{Binding Source={x:Reference SelectedPackage}}">
                <Fluent:RibbonGroupBox Visibility="Collapsed" IsEnabled="{Binding HasSingleSelection}">
                    <Fluent:SplitButton Header="Copy" CommandParameter="{x:Static enums:PackageProperty.Name}" Size="Middle">
                        <Fluent:SplitButton.Icon>
                            <Path Data="{StaticResource VectorCopy}" Style="{StaticResource MediumIcon}" />
                        </Fluent:SplitButton.Icon>
                        <Fluent:Button Header="Name" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Name}" />
                        <Fluent:Button Header="Full name" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.FullName}" />
                        <Fluent:Button Header="Version" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Version}"/>
                        <Fluent:Button Header="Publisher (display name)" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Publisher}" />
                        <Fluent:Button Header="Publisher (raw)" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Subject}" />
                        <Fluent:Button Header="Install path" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.InstallPath}" />
                    </Fluent:SplitButton>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox IsEnabled="{Binding HasSelection}" x:Name="RibbonManagementNavi" Header="Navigation">
                    <Fluent:RibbonGroupBox>
                        <Fluent:RibbonGroupBox.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:RibbonGroupBox.Icon>
                    </Fluent:RibbonGroupBox>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open install location" Command="{x:Static commands:MsixHeroCommands.OpenExplorer}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open user data location" Command="{x:Static commands:MsixHeroCommands.OpenExplorerUser}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open manifest" Command="{x:Static commands:MsixHeroCommands.OpenManifest}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 6 3 L 6 29 L 26 29 L 26 9.59375 L 25.71875 9.28125 L 19.71875 3.28125 L 19.40625 3 Z M 8 5 L 18 5 L 18 11 L 24 11 L 24 27 L 8 27 Z M 20 6.4375 L 22.5625 9 L 20 9 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open config.json" Command="{x:Static commands:MsixHeroCommands.OpenConfigJson}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorWrench}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonManagementControl"  Header="Control" IsEnabled="{Binding HasSelection}">
                    <Fluent:Button Header="Remove for current user" Command="Delete" ToolTip="Removes this app for the current user only">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>False</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorDeleteUser}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorDeleteUser}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Fluent:Button Command="Delete" Header="Remove for all users" ToolTip="Removes this app for all users">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorDeleteMachine}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                    </Fluent:Button>

                    <Fluent:Button Command="{x:Static commands:MsixHeroCommands.Deprovision}" Header="Deprovision for all users" ToolTip="De-provisions this package from all users">
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Style="{StaticResource LargeIcon}" Data="M 21.75 4 C 20.078125 4 18.492188 4.660156 17.3125 5.84375 L 15.84375 7.3125 C 14.660156 8.496094 14 10.078125 14 11.75 C 14 12.542969 14.152344 13.316406 14.4375 14.03125 L 16.0625 12.40625 C 15.859375 11.109375 16.253906 9.714844 17.25 8.71875 L 18.71875 7.25 C 19.523438 6.445313 20.613281 6 21.75 6 C 22.886719 6 23.945313 6.445313 24.75 7.25 C 26.410156 8.910156 26.410156 11.621094 24.75 13.28125 L 24.03125 14 C 24.886719 14.003906 25.710938 14.109375 26.5 14.3125 C 27.476563 13.179688 28 11.761719 28 10.25 C 28 8.578125 27.339844 7.027344 26.15625 5.84375 C 24.976563 4.660156 23.421875 4 21.75 4 Z M 19.28125 11.28125 L 11.28125 19.28125 L 12.71875 20.71875 L 20.71875 12.71875 Z M 11.75 14 C 10.078125 14 8.492188 14.660156 7.3125 15.84375 L 5.84375 17.3125 C 4.660156 18.496094 4 20.078125 4 21.75 C 4 23.421875 4.660156 24.972656 5.84375 26.15625 C 7.023438 27.339844 8.578125 28 10.25 28 C 11.761719 28 13.179688 27.476563 14.3125 26.5 C 14.109375 25.707031 14.003906 24.886719 14 24.03125 L 13.28125 24.75 C 12.476563 25.554688 11.386719 26 10.25 26 C 9.113281 26 8.054688 25.554688 7.25 24.75 C 5.589844 23.089844 5.589844 20.378906 7.25 18.71875 L 8.71875 17.25 C 9.523438 16.445313 10.613281 16 11.75 16 C 11.972656 16 12.191406 16.023438 12.40625 16.0625 L 14.03125 14.4375 C 13.316406 14.152344 12.542969 14 11.75 14 Z M 24 16 C 19.59375 16 16 19.59375 16 24 C 16 28.40625 19.59375 32 24 32 C 28.40625 32 32 28.40625 32 24 C 32 19.59375 28.40625 16 24 16 Z M 24 18 C 27.324219 18 30 20.675781 30 24 C 30 27.324219 27.324219 30 24 30 C 20.675781 30 18 27.324219 18 24 C 18 20.675781 20.675781 18 24 18 Z M 21.71875 20.28125 L 20.28125 21.71875 L 22.5625 24 L 20.28125 26.28125 L 21.71875 27.71875 L 24 25.4375 L 26.28125 27.71875 L 27.71875 26.28125 L 25.4375 24 L 27.71875 21.71875 L 26.28125 20.28125 L 24 22.5625 Z" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 21.75 4 C 20.078125 4 18.492188 4.660156 17.3125 5.84375 L 15.84375 7.3125 C 14.660156 8.496094 14 10.078125 14 11.75 C 14 12.542969 14.152344 13.316406 14.4375 14.03125 L 16.0625 12.40625 C 15.859375 11.109375 16.253906 9.714844 17.25 8.71875 L 18.71875 7.25 C 19.523438 6.445313 20.613281 6 21.75 6 C 22.886719 6 23.945313 6.445313 24.75 7.25 C 26.410156 8.910156 26.410156 11.621094 24.75 13.28125 L 24.03125 14 C 24.886719 14.003906 25.710938 14.109375 26.5 14.3125 C 27.476563 13.179688 28 11.761719 28 10.25 C 28 8.578125 27.339844 7.027344 26.15625 5.84375 C 24.976563 4.660156 23.421875 4 21.75 4 Z M 19.28125 11.28125 L 11.28125 19.28125 L 12.71875 20.71875 L 20.71875 12.71875 Z M 11.75 14 C 10.078125 14 8.492188 14.660156 7.3125 15.84375 L 5.84375 17.3125 C 4.660156 18.496094 4 20.078125 4 21.75 C 4 23.421875 4.660156 24.972656 5.84375 26.15625 C 7.023438 27.339844 8.578125 28 10.25 28 C 11.761719 28 13.179688 27.476563 14.3125 26.5 C 14.109375 25.707031 14.003906 24.886719 14 24.03125 L 13.28125 24.75 C 12.476563 25.554688 11.386719 26 10.25 26 C 9.113281 26 8.054688 25.554688 7.25 24.75 C 5.589844 23.089844 5.589844 20.378906 7.25 18.71875 L 8.71875 17.25 C 9.523438 16.445313 10.613281 16 11.75 16 C 11.972656 16 12.191406 16.023438 12.40625 16.0625 L 14.03125 14.4375 C 13.316406 14.152344 12.542969 14 11.75 14 Z M 24 16 C 19.59375 16 16 19.59375 16 24 C 16 28.40625 19.59375 32 24 32 C 28.40625 32 32 28.40625 32 24 C 32 19.59375 28.40625 16 24 16 Z M 24 18 C 27.324219 18 30 20.675781 30 24 C 30 27.324219 27.324219 30 24 30 C 20.675781 30 18 27.324219 18 24 C 18 20.675781 20.675781 18 24 18 Z M 21.71875 20.28125 L 20.28125 21.71875 L 22.5625 24 L 20.28125 26.28125 L 21.71875 27.71875 L 24 25.4375 L 26.28125 27.71875 L 27.71875 26.28125 L 25.4375 24 L 27.71875 21.71875 L 26.28125 20.28125 L 24 22.5625 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Fluent:Button Header="Start" IsEnabled="{Binding HasSingleSelection}" Command="{x:Static commands:MsixHeroCommands.RunPackage}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>False</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 9 5.15625 L 9 26.84375 L 10.53125 25.84375 L 25.84375 16 L 10.53125 6.15625 Z M 11 8.8125 L 22.15625 16 L 11 23.1875 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 9 5.15625 L 9 26.84375 L 10.53125 25.84375 L 25.84375 16 L 10.53125 6.15625 Z M 11 8.8125 L 22.15625 16 L 11 23.1875 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem 
                x:Name="RibbonTabVolumesManagement"
                Header="Management" 
                Group="{Binding Source={x:Reference SelectedVolume}}">
                <Fluent:RibbonGroupBox>
                    <Fluent:Button Header="Remove" Command="Delete">
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorDelete}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorDelete}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Separator />
                    <Fluent:Button Header="Set as default" Command="{x:Static commands:MsixHeroCommands.SetVolumeAsDefault}">
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorWrench}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorWrench}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Separator />
                    <Fluent:Button Header="Unmount">
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorDeleteUser}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorDeleteUser}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem 
                x:Name="RibbonTabDeveloper" 
                ReduceOrder="
                  (RibbonDevRun),(RibbonDevRun),(RibbonDevRun),
                  RibbonDevReg,RibbonDevReg,RibbonDevReg
                  RibbonDevCreate,RibbonDevCreate,RibbonDevCreate"
                  Header="Developer" 
                Group="{Binding Source={x:Reference SelectedPackage}}">
                <Fluent:RibbonGroupBox x:Name="RibbonDevCreate" Header="Create...">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Modification package stub..." Command="{x:Static commands:MsixHeroCommands.ModificationPackage}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Appinstaller definition..." Command="{x:Static commands:MsixHeroCommands.AppInstaller}" CommandParameter="{x:Static viewModel11:AppInstallerCommandParameter.Selection}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonDevRun" IsEnabled="{Binding HasSingleSelection}" Header="Run in package context">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorWindow}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:RibbonGroupBox.Resources>
                        <SolidColorBrush x:Key="WhiteBrush" Color="#fafafa" />
                    </Fluent:RibbonGroupBox.Resources>
                    <Fluent:InRibbonGallery Selectable="False" Background="White" ItemsSource="{Binding Tools}" MaxItemsInRow="4">
                        <Fluent:InRibbonGallery.ItemContainerStyle>
                            <Style TargetType="{x:Type Fluent:GalleryItem}">
                                <Setter Property="Command" Value="{x:Static commands:MsixHeroCommands.RunTool}" />
                                <Setter Property="CommandParameter" Value="{Binding Config}" />
                            </Style>
                        </Fluent:InRibbonGallery.ItemContainerStyle>
                        <Fluent:InRibbonGallery.ItemTemplate>
                            <DataTemplate>
                                <!--<Fluent:Button 
                                    IsDefinitive="True" 
                                    Header="{Binding Name}"           
                                    Command="{x:Static commands:MsixHeroCommands.RunTool}" CommandParameter="{Binding Config}">
                                    <Fluent:Button.LargeIcon>-->
                                <StackPanel Width="64" Margin="4">
                                    <uac:UACControl
                                        HorizontalAlignment="Center"
                                            ShowShield="{Binding Config.AsAdmin}">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <Image Width="16" Height="16" Source="{Binding Image}" 
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Center">
                                                <Image.Style>
                                                    <Style TargetType="Image">
                                                        <Style.Triggers>
                                                            <Trigger Property="Source" Value="{x:Null}">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Image.Style>
                                            </Image>

                                            <Viewbox 
                                                    VerticalAlignment="Center"
                                                    Width="16" 
                                                    Height="16" 
                                                    Tag="{Binding Image}"
                                                    SnapsToDevicePixels="True" 
                                                    UseLayoutRounding="True" 
                                                    HorizontalAlignment="Center">
                                                <Viewbox.Style>
                                                    <Style TargetType="Viewbox">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <Trigger Property="Tag" Value="{x:Null}">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Viewbox.Style>
                                                <Path Data="{StaticResource VectorGear}" Width="32" Height="32" Fill="{StaticResource Otor.MsixHero.Brushes.Accent}" />
                                            </Viewbox>
                                        </StackPanel>
                                    </uac:UACControl>
                                    <TextBlock FontSize="10" Text="{Binding Name}" TextWrapping="Wrap" TextAlignment="Center" Margin="0 2 0 0" />
                                </StackPanel>
                                <!--</Fluent:Button.LargeIcon>
                                    <Fluent:Button.Icon>
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <Image VerticalAlignment="Center" Width="16" Height="16" Source="{Binding Image}" HorizontalAlignment="Center">
                                                <Image.Style>
                                                    <Style TargetType="Image">
                                                        <Style.Triggers>
                                                            <Trigger Property="Source" Value="{x:Null}">
                                                                <Setter Property="Visibility" Value="Collapsed" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Image.Style>
                                            </Image>

                                            <Viewbox 
                                                VerticalAlignment="Center"
                                                Width="16" 
                                                Height="16" 
                                                Tag="{Binding Image}"
                                                SnapsToDevicePixels="True" 
                                                UseLayoutRounding="True" 
                                                HorizontalAlignment="Center">
                                                <Viewbox.Style>
                                                    <Style TargetType="Viewbox">
                                                        <Setter Property="Visibility" Value="Collapsed" />
                                                        <Style.Triggers>
                                                            <Trigger Property="Tag" Value="{x:Null}">
                                                                <Setter Property="Visibility" Value="Visible" />
                                                            </Trigger>
                                                        </Style.Triggers>
                                                    </Style>
                                                </Viewbox.Style>
                                                <Path Data="{StaticResource VectorGear}" Width="32" Height="32" Fill="{StaticResource Otor.MsixHero.Brushes.Accent}" />
                                            </Viewbox>
                                        </StackPanel>
                                    </Fluent:Button.Icon>
                                </Fluent:Button>-->
                                <!-- Image-->
                            </DataTemplate>
                        </Fluent:InRibbonGallery.ItemTemplate>
                        <Fluent:InRibbonGallery.Icon>
                            <Path Data="{StaticResource VectorWindow}" Style="{StaticResource MediumIcon}" />
                        </Fluent:InRibbonGallery.Icon>
                        <Fluent:InRibbonGallery.LargeIcon>
                            <Path Data="{StaticResource VectorWindow}" Style="{StaticResource LargeIcon}" />
                        </Fluent:InRibbonGallery.LargeIcon>
                        <Fluent:InRibbonGallery.Menu>
                            <Fluent:RibbonMenu>
                                <Fluent:MenuItem Header="Customize the tools..." Command="{x:Static commands:MsixHeroCommands.Settings}" CommandParameter="tools">
                                    <Fluent:MenuItem.Icon>
                                        <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorGear}" />
                                    </Fluent:MenuItem.Icon>
                                </Fluent:MenuItem>
                            </Fluent:RibbonMenu>
                        </Fluent:InRibbonGallery.Menu>
                    </Fluent:InRibbonGallery>
                    <!--<Fluent:Button Header="Customize the tools..." Command="{x:Static commands:MsixHeroCommands.Settings}">
                        <Fluent:Button .Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorGear}" />
                        </Fluent:Button>
                    </Fluent:Button>-->

                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonDevReg" IsEnabled="{Binding HasSingleSelection}" Header="Registry">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Load registry" Command="{x:Static commands:MsixHeroCommands.MountRegistry}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource LargeIcon}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Unload registry" Command="{x:Static commands:MsixHeroCommands.UnmountRegistry}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <uac:UACControl ShowShield="True">
                                <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource LargeIcon}" />
                            </uac:UACControl>
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
        </Fluent:Ribbon>
        <Border Background="#FFFFFF" Grid.Row="2">
            <progressOverlay:ProgressOverlay IsShown="{Binding IsLoading}" Progress="{Binding LoadingProgress}" Message="{Binding LoadingMessage}">
                <TabControl 
                    x:Name="TabControl"
                    regions:RegionManager.RegionName="{x:Static modules:Constants.RegionContent}">
                    <TabControl.Resources>
                        <Style TargetType="{x:Type TabItem}">
                            <Setter Property="Header" Value="{Binding DataContext.Header}"/>
                        </Style>
                    </TabControl.Resources>
                    <TabControl.Style>
                        <Style TargetType="{x:Type TabControl}">
                            <Setter Property="OverridesDefaultStyle" Value="True" />
                            <Setter Property="SnapsToDevicePixels" Value="True" />
                            <Setter Property="BorderBrush" Value="#D2D2D2" />
                            <Setter Property="VerticalAlignment" Value="Stretch" />
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalContentAlignment" Value="Stretch" />
                            <Setter Property="HorizontalContentAlignment" Value="Stretch" />
                            <Setter Property="Padding" Value="0 5 0 0" />
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="{x:Type TabControl}">
                                        <DockPanel>
                                            <StackPanel 
                                                DockPanel.Dock="Left"
                                                x:Name="HeaderPanel"
                                                Panel.ZIndex="1"
                                                Margin="{TemplateBinding Padding}"
                                                IsItemsHost="True"
                                                KeyboardNavigation.TabIndex="1"
                                                Background="Transparent" />
                                            <!--<Border Width="1" Background="{TemplateBinding BorderBrush}" VerticalAlignment="Stretch" />-->
                                            <Border x:Name="Border"
                                                KeyboardNavigation.TabNavigation="Local"
                                                KeyboardNavigation.DirectionalNavigation="Contained"
                                                KeyboardNavigation.TabIndex="2">
                                                <ContentPresenter x:Name="PART_SelectedContentHost"
                                                                  VerticalAlignment="{TemplateBinding VerticalContentAlignment}"
                                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                  ContentSource="SelectedContent" />
                                            </Border>
                                        </DockPanel>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="ItemContainerStyle">
                                <Setter.Value>
                                    <Style TargetType="{x:Type TabItem}">
                                        <Setter Property="Header" Value="{Binding DataContext.Header}" />
                                        <Setter Property="Tag" Value="{Binding DataContext.Icon}" />
                                        <Setter Property="Width" Value="42" />
                                        <Setter Property="Background" Value="Transparent" />
                                        <Setter Property="Height" Value="42" />
                                        <!--<Setter Property="VerticalContentAlignment" Value="Center" />
                                        <Setter Property="HorizontalContentAlignment" Value="Center" />-->
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="{x:Type TabItem}">
                                                    <Border Background="{TemplateBinding Background}" ToolTip="{TemplateBinding Header}">
                                                        <StackPanel 
                                                            HorizontalAlignment="Center"
                                                            VerticalAlignment="Center">
                                                            <Viewbox Width="24" Height="24">
                                                                <Path 
                                                                Width="32"
                                                                Height="32"
                                                                Fill="{StaticResource Otor.MsixHero.Brushes.Accent}"
                                                                IsHitTestVisible="False"
                                                                x:Name="ContentIcon"
                                                                Data="{TemplateBinding Tag}"/>
                                                            </Viewbox>
                                                            <ContentPresenter 
                                                                Visibility="Collapsed"
                                                                IsHitTestVisible="False"
                                                                x:Name="ContentSite"
                                                                ContentSource="Header"
                                                                TextBlock.FontSize="8"
                                                                RecognizesAccessKey="True" />
                                                        </StackPanel>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="Tag" Value="{x:Null}">
                                                            <Setter Property="Visibility" TargetName="ContentIcon" Value="Collapsed" />
                                                            <Setter Property="Visibility" TargetName="ContentSite" Value="Visible" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="#CDE6F7" />
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#B1D6F0" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </TabControl.Style>
                </TabControl>
            </progressOverlay:ProgressOverlay>
        </Border>
        <Fluent:StatusBar Grid.Row="3">
            <Fluent:StatusBarItem 
                    Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                    Title="Second left placed item"
                    Content="{Binding LoadingMessage}"
                    HorizontalAlignment="Right" />
        </Fluent:StatusBar>
    </Grid>
</UserControl>