<UserControl x:Class="otor.msixhero.ui.Modules.Main.View.MainView"
                     xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                     xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                     xmlns:Fluent="urn:fluent-ribbon"
                     regions:ViewModelLocator.AutoWireViewModel="True"
                     xmlns:regions="http://prismlibrary.com/"
                     xmlns:xctk="http://schemas.xceed.com/wpf/xaml/toolkit"
                     xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                     xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                     xmlns:routedCommand="clr-namespace:otor.msixhero.ui.Commands.RoutedCommand"
                     xmlns:commands="clr-namespace:otor.msixhero.ui.Commands"
                     xmlns:viewModel="clr-namespace:otor.msixhero.ui.Modules.Main.ViewModel"
                     xmlns:system="clr-namespace:System;assembly=System.Runtime"
                     xmlns:enums="clr-namespace:otor.msixhero.lib.Domain.Appx.Packages;assembly=otor.msixhero.lib"
                     xmlns:view="clr-namespace:otor.msixhero.ui.Modules.Main.View"
                     d:DesignWidth="600"
                     mc:Ignorable="d"
                     d:DataContext="{d:DesignInstance viewModel:MainViewModel}">
    <UserControl.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary Source="/otor.msixhero.ui;component/Themes/Generic.xaml" />
                <ResourceDictionary Source="/otor.msixhero.ui;component/Themes/Converters.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </UserControl.Resources>
    <UserControl.CommandBindings>
        <CommandBinding Command="Close" Executed="Close_OnExecuted"></CommandBinding>
    </UserControl.CommandBindings>
    <routedCommand:RoutedCommandHandlers.Commands>
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.RunTool}" Command="{Binding CommandHandler.RunTool}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenManifest}" Command="{Binding CommandHandler.OpenManifest}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenConfigJson}" Command="{Binding CommandHandler.OpenConfigJson}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenExplorer}" Command="{Binding CommandHandler.OpenExplorer}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenExplorerUser}" Command="{Binding CommandHandler.OpenExplorerUser}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.RunPackage}" Command="{Binding CommandHandler.RunApp}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="Refresh" Command="{Binding CommandHandler.Refresh}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="Delete" Command="{Binding CommandHandler.RemovePackage}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenPowerShell}" Command="{Binding CommandHandler.OpenPowerShell}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenLogs}" Command="{Binding CommandHandler.OpenLogs}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.MountRegistry}" Command="{Binding CommandHandler.MountRegistry}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.UnmountRegistry}" Command="{Binding CommandHandler.UnmountRegistry}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.RemovePackage}" Command="{Binding CommandHandler.RemovePackage}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.CreateSelfSign}" Command="{Binding CommandHandler.NewSelfSignedCert}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.ExtractCertifiacte}" Command="{Binding CommandHandler.ExtractCert}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.InstallCertificate}" Command="{Binding CommandHandler.InstallCertificate}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenResign}" Command="{Binding CommandHandler.OpenResign}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.CertManager}" Command="{Binding CommandHandler.CertManager}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.AddPackage}" Command="{Binding CommandHandler.AddPackage}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenAppsFeatures}" Command="{Binding CommandHandler.OpenAppsFeatures}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.OpenDevSettings}" Command="{Binding CommandHandler.OpenDevSettings}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Pack}" Command="{Binding CommandHandler.Pack}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.AppInstaller}" Command="{Binding CommandHandler.AppInstaller}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.ModificationPackage}" Command="{Binding CommandHandler.ModificationPackage}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Unpack}" Command="{Binding CommandHandler.Unpack}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="{x:Static commands:MsixHeroCommands.Settings}" Command="{Binding CommandHandler.Settings}" />
        <routedCommand:RoutedCommandHandler RoutedCommand="Copy" Command="{Binding CommandHandler.Copy}" />
    </routedCommand:RoutedCommandHandlers.Commands>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <Grid.Resources>
            <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter" />
        </Grid.Resources>

        <Fluent:Ribbon
            CanQuickAccessLocationChanging="False"
            CanCustomizeQuickAccessToolBar="False"
            CanCustomizeRibbon="False"
            IsQuickAccessToolBarMenuDropDownVisible="False"
            CanCustomizeQuickAccessToolBarItems="False"
            x:Name="Ribbon"  Grid.Row="0">
            <Fluent:Ribbon.ContextualGroups>
                <Fluent:RibbonContextualTabGroup 
                    x:Name="ToolsGroup"
                    Header="Selected package" 
                    Visibility="Collapsed"
                    Background="GreenYellow" 
                    BorderBrush="LightGreen" />
            </Fluent:Ribbon.ContextualGroups>

            <!--Backstage-->
            <Fluent:Ribbon.Menu>
                <Fluent:Backstage>
                    <Fluent:BackstageTabControl>
                        <Fluent:BackstageTabItem Header="New">
                            <Fluent:BackstageTabItem.Icon>
                                <Path Fill="White" Opacity="0.7" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorBulb}" />
                            </Fluent:BackstageTabItem.Icon>
                            <view:BackStageNewView />
                        </Fluent:BackstageTabItem>
                        <Fluent:Button Header="Settings" Command="{x:Static commands:MsixHeroCommands.Settings}">
                            <Fluent:Button.Icon>
                                <Path Opacity="0.7" Fill="White" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorGear}" />
                            </Fluent:Button.Icon>
                        </Fluent:Button>
                        <Fluent:SeparatorTabItem />
                        <Fluent:Button Header="Exit" Command="Close">
                            <Fluent:Button.Icon>
                                <Path Fill="White" Opacity="0.7" Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerOff}" />
                            </Fluent:Button.Icon>
                        </Fluent:Button>
                    </Fluent:BackstageTabControl>
                </Fluent:Backstage>
            </Fluent:Ribbon.Menu>

            <!--Tabs-->
            <Fluent:RibbonTabItem Header="Home" ReduceOrder="
                                      RibbonHomeActions,RibbonHomeActions,RibbonHomeActions,
                                      RibbonHomeTroubleshooting,RibbonHomeTroubleshooting,RibbonHomeTroubleshooting">

                <Fluent:RibbonGroupBox x:Name="RibbonHomeActions" Header="Actions">
                    <Fluent:Button Size="Large" Header="Refresh list" Command="Refresh" SizeDefinition="Large, Large, Small">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Install package from file..." Command="{x:Static commands:MsixHeroCommands.AddPackage}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="M 16 3 C 8.832031 3 3 8.832031 3 16 C 3 23.167969 8.832031 29 16 29 C 23.167969 29 29 23.167969 29 16 C 29 8.832031 23.167969 3 16 3 Z M 16 5 C 22.085938 5 27 9.914063 27 16 C 27 22.085938 22.085938 27 16 27 C 9.914063 27 5 22.085938 5 16 C 5 9.914063 9.914063 5 16 5 Z M 15 10 L 15 15 L 10 15 L 10 17 L 15 17 L 15 22 L 17 22 L 17 17 L 22 17 L 22 15 L 17 15 L 17 10 Z" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox x:Name="RibbonHomeTroubleshooting" Header="Troubleshooting and diagnostics" >
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorDebugging}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Open PowerShell" Command="{x:Static commands:MsixHeroCommands.OpenPowerShell}" SizeDefinition="Large, Medium, Medium">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorPowerShell}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerShell}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Open MSIX logs" Command="{x:Static commands:MsixHeroCommands.OpenLogs}" SizeDefinition="Large, Medium, Medium">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorLogs}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorLogs}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Separator />
                    <Fluent:Button Header="Apps and features" SizeDefinition="Medium,Medium,Small" Command="{x:Static commands:MsixHeroCommands.OpenAppsFeatures}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorPowerList}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorPowerList}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Developer settings" SizeDefinition="Medium,Medium,Small" Command="{x:Static commands:MsixHeroCommands.OpenDevSettings}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem Header="View"
                                      ReduceOrder="RibbonViewGroupBy,RibbonViewGroupBy,RibbonViewGroupBy">

                <Fluent:RibbonGroupBox x:Name="RibbonHomeContext" Header="Context">
                    <Fluent:Button Size="Large" Header="Refresh list" Command="Refresh" SizeDefinition="Large, Large, Small">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 16 4 C 10.886719 4 6.617188 7.160156 4.875 11.625 L 6.71875 12.375 C 8.175781 8.640625 11.710938 6 16 6 C 19.242188 6 22.132813 7.589844 23.9375 10 L 20 10 L 20 12 L 27 12 L 27 5 L 25 5 L 25 8.09375 C 22.808594 5.582031 19.570313 4 16 4 Z M 25.28125 19.625 C 23.824219 23.359375 20.289063 26 16 26 C 12.722656 26 9.84375 24.386719 8.03125 22 L 12 22 L 12 20 L 5 20 L 5 27 L 7 27 L 7 23.90625 C 9.1875 26.386719 12.394531 28 16 28 C 21.113281 28 25.382813 24.839844 27.125 20.375 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>

                    <Separator />

                    <Fluent:RadioButton GroupName="Users1" Header="Current user" IsChecked="{Binding Context, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:PackageContext.CurrentUser}}">
                        <Fluent:RadioButton.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:RadioButton.SizeDefinition>
                        <Fluent:RadioButton.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:RadioButton.Icon>
                    </Fluent:RadioButton>
                    <Fluent:RadioButton GroupName="Users2" Header="All users" IsChecked="{Binding Context, Converter={StaticResource EnumToBooleanConverter}, ConverterParameter={x:Static enums:PackageContext.AllUsers}}">
                        <Fluent:RadioButton.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:RadioButton.SizeDefinition>
                        <Fluent:RadioButton.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUsers}" />
                        </Fluent:RadioButton.Icon>
                    </Fluent:RadioButton>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="App types">
                    <Fluent:CheckBox IsChecked="{Binding ShowStoreApps, Converter={StaticResource NegativeConverter}}" Header="Hide Store apps" />
                    <Fluent:CheckBox IsChecked="{Binding ShowSideLoadedApps, Converter={StaticResource NegativeConverter}}" Header="Hide Side-loaded apps" />
                    <Fluent:CheckBox IsChecked="{Binding ShowSystemApps, Converter={StaticResource NegativeConverter}}" Header="Hide System apps" />
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Group by" x:Name="RibbonViewGroupBy">
                    <Fluent:InRibbonGallery Orientation="Horizontal" ItemWidth="64" ItemHeight="58" 
                                                SelectedValue="{Binding Group}" SelectedValuePath="Tag" Size="Large">
                        <Fluent:InRibbonGallery.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Large" Small="Middle" />
                        </Fluent:InRibbonGallery.SizeDefinition>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.None}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorCollection}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="None" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.Publisher}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorUsers2}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="Publisher" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                        <Fluent:GalleryItem Tag="{x:Static enums:PackageGroup.Type}">
                            <StackPanel>
                                <Path HorizontalAlignment="Center" Data="{StaticResource VectorBulb}" Style="{StaticResource LargeIcon}" />
                                <TextBlock TextAlignment="Center" Text="Type" />
                            </StackPanel>
                        </Fluent:GalleryItem>
                    </Fluent:InRibbonGallery>
                </Fluent:RibbonGroupBox>

                <Fluent:RibbonGroupBox Header="Panel">
                    <Fluent:ToggleButton Header="Show information panel" Size="Large" IsChecked="{Binding ShowSidebar}">
                        <Fluent:ToggleButton.LargeIcon>
                            <Path Data="{StaticResource VectorSidebarRight}" Style="{StaticResource LargeIcon}" />
                        </Fluent:ToggleButton.LargeIcon>
                    </Fluent:ToggleButton>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem Header="Generate" ReduceOrder="
                            RibbonToolsCreate,RibbonToolsCreate,RibbonToolsCreate,">
                <Fluent:RibbonGroupBox Header="Create" x:Name="RibbonToolsCreate">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Generate modification package stub..." Command="{x:Static commands:MsixHeroCommands.ModificationPackage}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Generate appinstaller definition..." Command="{x:Static commands:MsixHeroCommands.AppInstaller}">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Visibility="Collapsed" Header="Generate bundle...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorBundle}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorBundle}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Visibility="Collapsed" Header="Generate MSIX Core...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorBulb}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorBulb}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Visibility="Collapsed" Header="Inject PSF...">
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorImport}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorImport}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem Header="Tools"
                    ReduceOrder="RibbonToolsCerts1,RibbonToolsCerts1,RibbonToolsCerts1,
                            RibbonToolsPack,RibbonToolsPack,RibbonToolsPack,
                            RibbonToolsCerts2,RibbonToolsCerts2,RibbonToolsCerts2">
                <Fluent:RibbonGroupBox Header="Packing + unpacking" x:Name="RibbonToolsPack">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorPack}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Unpack MSIX package..." Command="{x:Static commands:MsixHeroCommands.Unpack}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Small" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorUnpack}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorUnpack}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Pack folder to MSIX..." Command="{x:Static commands:MsixHeroCommands.Pack}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Small" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorPack}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorPack}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Code-signing" x:Name="RibbonToolsCerts1">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorSelfSign}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Create self-signed..." Command="{x:Static commands:MsixHeroCommands.CreateSelfSign}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSelfSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Sign package..." Command="{x:Static commands:MsixHeroCommands.OpenResign}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSign}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Extract certificate from MSIX..." Command="{x:Static commands:MsixHeroCommands.ExtractCertifiacte}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorExport}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Large" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox Header="Certificate management" x:Name="RibbonToolsCerts2">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorSign}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Install certificate..." Command="{x:Static commands:MsixHeroCommands.InstallCertificate}">
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorImport}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorImport}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Large" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="User certificates" Command="{x:Static commands:MsixHeroCommands.CertManager}">
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorUser}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                    <Fluent:Button Header="Computer certificates" Command="{x:Static commands:MsixHeroCommands.CertManager}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>

                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorSystem}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="{StaticResource VectorSystem}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
            <Fluent:RibbonTabItem 
                    ReduceOrder="
                        RibbonManagementNavi,RibbonManagementNavi,RibbonManagementNavi,
                        RibbonManagementControl,RibbonManagementControl,RibbonManagementControl"
                    x:Name="TabMaintenance" Header="Management" Group="{Binding Source={x:Reference ToolsGroup}}">
                <Fluent:RibbonGroupBox Visibility="Collapsed" IsEnabled="{Binding HasSingleSelection}">
                    <Fluent:SplitButton Header="Copy" CommandParameter="{x:Static enums:PackageProperty.Name}" Size="Middle">
                        <Fluent:SplitButton.Icon>
                            <Path Data="{StaticResource VectorCopy}" Style="{StaticResource MediumIcon}" />
                        </Fluent:SplitButton.Icon>
                        <Fluent:Button Header="Name" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Name}" />
                        <Fluent:Button Header="Full name" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.FullName}" />
                        <Fluent:Button Header="Version" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Version}"/>
                        <Fluent:Button Header="Publisher (display name)" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Publisher}" />
                        <Fluent:Button Header="Publisher (raw)" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.Subject}" />
                        <Fluent:Button Header="Install path" Command="Copy" CommandParameter="{x:Static enums:PackageProperty.InstallPath}" />
                    </Fluent:SplitButton>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox IsEnabled="{Binding HasSelection}" x:Name="RibbonManagementNavi" Header="Navigation">
                    <Fluent:RibbonGroupBox>
                        <Fluent:RibbonGroupBox.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:RibbonGroupBox.Icon>
                    </Fluent:RibbonGroupBox>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open install location" Command="{x:Static commands:MsixHeroCommands.OpenExplorer}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open user data location" Command="{x:Static commands:MsixHeroCommands.OpenExplorerUser}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 3 5 L 3 10 L 3 27 L 7 27 L 7 29 L 13.007812 29 L 12.992188 27 L 19.037109 27 L 19.050781 29 L 25 29 L 25 27 L 29 27 L 29 7 L 13.414062 7 L 11.414062 5 L 3 5 z M 5 7 L 10.585938 7 L 11.585938 8 L 10.587891 9 L 5 9.0019531 L 5 7 z M 13.414062 9 L 27 9 L 27 25 L 25 25 L 25 17 L 7 17 L 7 18 L 7 25 L 5 25 L 5 11.001953 L 11.416016 11 L 13.414062 9 z M 9 19 L 23 19 L 23 27 L 21.037109 27 L 20.992188 21 L 10.949219 21 L 10.992188 27 L 9 27 L 9 19 z M 12.962891 23 L 19.007812 23 L 19.021484 25 L 12.978516 25 L 12.962891 23 z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open manifest" Command="{x:Static commands:MsixHeroCommands.OpenManifest}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="M 6 3 L 6 29 L 26 29 L 26 9.59375 L 25.71875 9.28125 L 19.71875 3.28125 L 19.40625 3 Z M 8 5 L 18 5 L 18 11 L 24 11 L 24 27 L 8 27 Z M 20 6.4375 L 22.5625 9 L 20 9 Z" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button IsEnabled="{Binding HasSingleSelection}" Header="Open config.json" Command="{x:Static commands:MsixHeroCommands.OpenConfigJson}" CommandParameter="{Binding SelectedPackage}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Middle" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.Icon>
                            <Path Style="{StaticResource MediumIcon}" Data="{StaticResource VectorWrench}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonManagementControl"  Header="Control">
                    <Fluent:SplitButton IsEnabled="{Binding HasSelection}" Header="Remove" Command="Delete" ToolTip="Removes this app for the current user only">
                        <Fluent:SplitButton.CommandParameter>
                            <system:Boolean>False</system:Boolean>
                        </Fluent:SplitButton.CommandParameter>
                        <Fluent:SplitButton.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 9.383 4 4 9.383 4 16 C 4 16.672 4.0647344 17.339 4.1777344 18 L 6.2128906 18 C 6.0758906 17.341 6 16.673 6 16 C 6 10.486 10.486 6 16 6 C 21.514 6 26 10.486 26 16 C 26 16.087545 25.988867 16.174352 25.986328 16.261719 C 25.349748 16.097269 24.6861 16 24 16 C 21.488603 16 19.240982 17.175028 17.771484 19 L 4 19 L 4 27 L 16.591797 27 C 17.78536 29.923538 20.66037 32 24 32 C 28.4 32 32 28.4 32 24 C 32 21.034216 30.36099 18.43607 27.947266 17.054688 C 27.980835 16.704504 28 16.353089 28 16 C 28 9.383 22.617 4 16 4 z M 16 8 C 11.593562 8 8 11.593562 8 16 L 10 16 C 10 12.674438 12.674438 10 16 10 L 16 8 z M 16 13 C 14.346 13 13 14.346 13 16 C 13 16.771 13.300297 17.468 13.779297 18 L 18.220703 18 C 18.700703 17.468 19 16.771 19 16 C 19 14.346 17.654 13 16 13 z M 16 15 C 16.552 15 17 15.449 17 16 C 17 16.551 16.552 17 16 17 C 15.448 17 15 16.551 15 16 C 15 15.449 15.448 15 16 15 z M 24 18 C 27.3 18 30 20.7 30 24 C 30 27.3 27.3 30 24 30 C 20.7 30 18 27.3 18 24 C 18 20.7 20.7 18 24 18 z M 21.699219 20.300781 L 20.300781 21.699219 L 22.599609 24 L 20.300781 26.300781 L 21.699219 27.699219 L 24 25.400391 L 26.300781 27.699219 L 27.699219 26.300781 L 25.400391 24 L 27.699219 21.699219 L 26.300781 20.300781 L 24 22.599609 L 21.699219 20.300781 z M 6 21 L 16.591797 21 C 16.212827 21.928256 16 22.93963 16 24 C 16 24.339374 16.028764 24.67143 16.070312 25 L 6 25 L 6 21 z" />
                        </Fluent:SplitButton.LargeIcon>
                        <Fluent:Button Command="Delete" Header="Remove for all users" ToolTip="Removes this app for all users">
                            <Fluent:Button.CommandParameter>
                                <system:Boolean>True</system:Boolean>
                            </Fluent:Button.CommandParameter>
                            <Fluent:Button.LargeIcon>
                                <Path Style="{StaticResource LargeIcon}" Data="M 16 4 C 9.383 4 4 9.383 4 16 C 4 16.672 4.0647344 17.339 4.1777344 18 L 6.2128906 18 C 6.0758906 17.341 6 16.673 6 16 C 6 10.486 10.486 6 16 6 C 21.514 6 26 10.486 26 16 C 26 16.087545 25.988867 16.174352 25.986328 16.261719 C 25.349748 16.097269 24.6861 16 24 16 C 21.488603 16 19.240982 17.175028 17.771484 19 L 4 19 L 4 27 L 16.591797 27 C 17.78536 29.923538 20.66037 32 24 32 C 28.4 32 32 28.4 32 24 C 32 21.034216 30.36099 18.43607 27.947266 17.054688 C 27.980835 16.704504 28 16.353089 28 16 C 28 9.383 22.617 4 16 4 z M 16 8 C 11.593562 8 8 11.593562 8 16 L 10 16 C 10 12.674438 12.674438 10 16 10 L 16 8 z M 16 13 C 14.346 13 13 14.346 13 16 C 13 16.771 13.300297 17.468 13.779297 18 L 18.220703 18 C 18.700703 17.468 19 16.771 19 16 C 19 14.346 17.654 13 16 13 z M 16 15 C 16.552 15 17 15.449 17 16 C 17 16.551 16.552 17 16 17 C 15.448 17 15 16.551 15 16 C 15 15.449 15.448 15 16 15 z M 24 18 C 27.3 18 30 20.7 30 24 C 30 27.3 27.3 30 24 30 C 20.7 30 18 27.3 18 24 C 18 20.7 20.7 18 24 18 z M 21.699219 20.300781 L 20.300781 21.699219 L 22.599609 24 L 20.300781 26.300781 L 21.699219 27.699219 L 24 25.400391 L 26.300781 27.699219 L 27.699219 26.300781 L 25.400391 24 L 27.699219 21.699219 L 26.300781 20.300781 L 24 22.599609 L 21.699219 20.300781 z M 6 21 L 16.591797 21 C 16.212827 21.928256 16 22.93963 16 24 C 16 24.339374 16.028764 24.67143 16.070312 25 L 6 25 L 6 21 z" />
                            </Fluent:Button.LargeIcon>
                        </Fluent:Button>
                    </Fluent:SplitButton>

                    <Fluent:Button Header="Start" IsEnabled="{Binding HasSingleSelection}" Command="{x:Static commands:MsixHeroCommands.RunPackage}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>False</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Style="{StaticResource LargeIcon}" Data="M 9 5.15625 L 9 26.84375 L 10.53125 25.84375 L 25.84375 16 L 10.53125 6.15625 Z M 11 8.8125 L 22.15625 16 L 11 23.1875 Z" />
                        </Fluent:Button.LargeIcon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>

            <Fluent:RibbonTabItem x:Name="TabDeveloper" 
                    ReduceOrder="
                      (RibbonDevRun),(RibbonDevRun),(RibbonDevRun),
                      RibbonDevReg,RibbonDevReg,RibbonDevReg
                      RibbonDevCreate,RibbonDevCreate,RibbonDevCreate"
                      Header="Developer" Group="{Binding Source={x:Reference ToolsGroup}}">
                <Fluent:RibbonGroupBox x:Name="RibbonDevCreate" Header="Create...">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Modification package stub..." Command="{x:Static commands:MsixHeroCommands.ModificationPackage}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorTransform}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Appinstaller definition..." Command="{x:Static commands:MsixHeroCommands.AppInstaller}">
                        <Fluent:Button.CommandParameter>
                            <system:Boolean>True</system:Boolean>
                        </Fluent:Button.CommandParameter>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorSetup}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Small="Middle" Middle="Middle" />
                        </Fluent:Button.SizeDefinition>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonDevRun" IsEnabled="{Binding HasSingleSelection}" Header="Run in package context">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorWindow}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:InRibbonGallery ItemsSource="{Binding Tools}" MaxItemsInRow="5">
                        <Fluent:InRibbonGallery.ItemTemplate>
                            <DataTemplate>
                                <Fluent:Button 
                                    IsDefinitive="True" 
                                    Header="{Binding Name}"           
                                    Command="{x:Static commands:MsixHeroCommands.RunTool}" CommandParameter="{Binding Path}">
                                    <Fluent:Button.LargeIcon>
                                        <Image Width="16" Height="16" Source="{Binding Image}" HorizontalAlignment="Center" />
                                    </Fluent:Button.LargeIcon>
                                    <Fluent:Button.Icon>
                                        <Image Width="16" Height="16" Source="{Binding Image}" HorizontalAlignment="Center" />
                                    </Fluent:Button.Icon>
                                    <!--<StackPanel>
                                        <Image Width="24" Height="24" Source="{Binding Image}" HorizontalAlignment="Center" />
                                        <TextBlock TextWrapping="Wrap" Text="{Binding Name}" HorizontalAlignment="Center" Margin="0 4 0 0" />
                                    </StackPanel>-->
                                </Fluent:Button>
                                <!-- Image-->
                            </DataTemplate>
                        </Fluent:InRibbonGallery.ItemTemplate>
                        <Fluent:InRibbonGallery.Icon>
                            <Path Data="{StaticResource VectorWindow}" Style="{StaticResource MediumIcon}" />
                        </Fluent:InRibbonGallery.Icon>
                        <Fluent:InRibbonGallery.LargeIcon>
                            <Path Data="{StaticResource VectorWindow}" Style="{StaticResource LargeIcon}" />
                        </Fluent:InRibbonGallery.LargeIcon>
                    </Fluent:InRibbonGallery>
                    
                </Fluent:RibbonGroupBox>
                <Fluent:RibbonGroupBox x:Name="RibbonDevReg" IsEnabled="{Binding HasSingleSelection}" Header="Registry">
                    <Fluent:RibbonGroupBox.Icon>
                        <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                    </Fluent:RibbonGroupBox.Icon>
                    <Fluent:Button Header="Load registry" Command="{x:Static commands:MsixHeroCommands.MountRegistry}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                    <Fluent:Button Header="Unload registry" Command="{x:Static commands:MsixHeroCommands.UnmountRegistry}">
                        <Fluent:Button.SizeDefinition>
                            <Fluent:RibbonControlSizeDefinition Large="Large" Middle="Middle" Small="Small" />
                        </Fluent:Button.SizeDefinition>
                        <Fluent:Button.LargeIcon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource LargeIcon}" />
                        </Fluent:Button.LargeIcon>
                        <Fluent:Button.Icon>
                            <Path Data="{StaticResource VectorRegistry}" Style="{StaticResource MediumIcon}" />
                        </Fluent:Button.Icon>
                    </Fluent:Button>
                </Fluent:RibbonGroupBox>
            </Fluent:RibbonTabItem>
        </Fluent:Ribbon>

        <Border Background="#FFFFFF" Grid.Row="2" >
            <xctk:BusyIndicator IsBusy="{Binding IsLoading}" BusyContent="{Binding LoadingMessage}">
                <xctk:BusyIndicator.ProgressBarStyle>
                    <Style TargetType="ProgressBar">
                        <Setter Property="Value" Value="{Binding LoadingProgress, Mode=OneWay}" />
                        <Setter Property="Margin" Value="10" />
                        <Setter Property="Height" Value="10" />
                        <Style.Triggers>
                            <Trigger Property="Value">
                                <Trigger.Value>
                                    <system:Double>0</system:Double>
                                </Trigger.Value>
                                <Setter Property="IsIndeterminate" Value="True" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </xctk:BusyIndicator.ProgressBarStyle>
                <ContentControl regions:RegionManager.RegionName="ContentRegion" />
            </xctk:BusyIndicator>
        </Border>
        <Fluent:StatusBar Grid.Row="3">
            <Fluent:StatusBarItem 
                    Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}"
                    Title="Second left placed item"
                    Content="{Binding LoadingMessage}"
                    HorizontalAlignment="Right" />
        </Fluent:StatusBar>
    </Grid>
</UserControl>